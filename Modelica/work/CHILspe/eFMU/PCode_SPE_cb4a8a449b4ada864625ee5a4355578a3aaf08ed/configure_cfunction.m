function configure_cfunction(block)
% CONFIGURE_CFUNCTION  Configure a C Function block to interface with the
%   eFMI production code. This function has been automatically generated
%   with eFMPy 0.1.0.
%
%   CONFIGURE_CFUNCTION() configure the current block.
%
%   CONFIGURE_CFUNCTION(BLOCK) configure BLOCK.

if nargin == 0
    block = gcb;
end

if ~strcmp(get_param(block, 'BlockType'), 'CFunction')
    error('Block to configure must be of type CFunction.')
end

set_param(block, 'SampleTime', '1.00000000000000005e-4')

[pcode_dir, ~, ~] = fileparts(mfilename('fullpath'));

StartCode = [
'sii_Startup_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed();' newline ...
'' newline ...
'#ifdef RT' newline ...
'block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.K0 = K0;' newline ...
'#else' newline ...
'block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.K0 = K0;' newline ...
'#endif' newline ...
'' newline ...
'sii_Recalibrate_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed();' newline ...
'' newline ...
'#ifdef RT' newline ...
'Pgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Pgen;' newline ...
'Qgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Qgen;' newline ...
'v = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.v;' newline ...
'vf0OUT = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.vf0OUT;' newline ...
'w = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.w;' newline ...
'#else' newline ...
'Pgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Pgen;' newline ...
'Qgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Qgen;' newline ...
'v = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.v;' newline ...
'vf0OUT = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.vf0OUT;' newline ...
'w = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.w;' newline ...
'#endif' newline ...
];

set_param(block, 'StartCode', StartCode);

OutputCode = [
'#ifdef RT' newline ...
'block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.fault = !!fault;' newline ...
'block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.vf = vf;' newline ...
'#else' newline ...
'block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.fault = !!fault;' newline ...
'block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.vf = vf;' newline ...
'#endif' newline ...
'' newline ...
'sii_DoStep_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed();' newline ...
'' newline ...
'#ifdef RT' newline ...
'Pgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Pgen;' newline ...
'Qgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Qgen;' newline ...
'v = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.v;' newline ...
'vf0OUT = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.vf0OUT;' newline ...
'w = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.w;' newline ...
'#else' newline ...
'Pgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Pgen;' newline ...
'Qgen = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.Qgen;' newline ...
'v = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.v;' newline ...
'vf0OUT = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.vf0OUT;' newline ...
'w = block_state_Hc234cad58156ccbc9047c71532b337747dea4c15_cb4a8a449b4ada864625ee5a4355578a3aaf08ed.w;' newline ...
'#endif' newline ...
];

set_param(block, 'OutputCode', OutputCode);

SimCustomHeaderFile = [
'#include "sii_block_interface.h"' newline ...
];

set_param(block, 'SimCustomHeaderFile', SimCustomHeaderFile)

SimCustomSourceFile = [
fullfile(pcode_dir, 'galec_stl.c') newline ...
fullfile(pcode_dir, 'sii_block_interface.c') newline ...
fullfile(pcode_dir, 'block.c') newline ...
];

set_param(block, 'SimCustomSourceFile', SimCustomSourceFile)

SimCustomSearchDirectory = [
fullfile(pcode_dir, '.') newline ...
];

set_param(block, 'SimCustomSearchDirectory', SimCustomSearchDirectory)

symbols = get_param(block, 'SymbolSpec');

% parameters

symbol = addSymbol(symbols, 'K0');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Parameter';
symbol.Label = 'K0';

% inputs

symbol = addSymbol(symbols, 'fault');
symbol.Type  = 'boolean';
symbol.Size  = '1';
symbol.Scope = 'Input';
symbol.Label = 'fault';

symbol = addSymbol(symbols, 'vf');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Input';
symbol.Label = 'vf';

% outputs

symbol = addSymbol(symbols, 'Pgen');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Output';
symbol.Label = 'Pgen';

symbol = addSymbol(symbols, 'Qgen');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Output';
symbol.Label = 'Qgen';

symbol = addSymbol(symbols, 'v');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Output';
symbol.Label = 'v';

symbol = addSymbol(symbols, 'vf0OUT');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Output';
symbol.Label = 'vf0OUT';

symbol = addSymbol(symbols, 'w');
symbol.Type  = 'single';
symbol.Size  = '1';
symbol.Scope = 'Output';
symbol.Label = 'w';

% block parameters
set_param(block, 'K0', '3.0e+1');

end